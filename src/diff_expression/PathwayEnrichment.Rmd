---
title: "Pathway Enrichment"
author: "Arjun Baghela"
date: "4/3/2017"
output: html_document
---

```{r}
library(tidyverse)
library(sigora)
```


```{r}

conHigh <- readRDS("~/Desktop/team_Undecided/processed_data/controlHighResults.rds")
conLow <- readRDS("~/Desktop/team_Undecided/processed_data/controlLowResults.rds")
highLow <- readRDS("~/Desktop/team_Undecided/processed_data/highLowResults.rds")

conHigh <- conHigh[conHigh$fdr==0,]$gene_pair %>% strsplit(".", fixed= TRUE) %>% unlist() %>% unique()

conLow <- conLow[conLow$fdr==0,]$gene_pair %>% strsplit(".", fixed= TRUE) %>% unlist() %>% unique()

highLow <- highLow[highLow$fdr==0,]$gene_pair %>% strsplit(".", fixed= TRUE) %>% unlist() %>% unique()




test <- conHigh %>% filter(fdr <= 0.05) %>% filter(abs_correlation_change >5)
test1 <- conLow %>% filter(fdr <= 0.05) %>% filter(abs_correlation_change >5)
test2 <- highLow %>% filter(fdr <= 0.05) %>% filter(abs_correlation_change > 5)

intersect(test$gene_pair, test1$gene_pair) %>% unique()

```


```{r}
data("kegH")
sigoraResconHigh <- sigora(GPSrepo= kegH, level= 2, queryList = conHigh)
sigoraResconLow <- sigora(GPSrepo= kegH, level= 2, queryList = conLow)
sigoraReshighLow <- sigora(GPSrepo= kegH, level= 2, queryList = highLow)
```

